# AlphaVelocity Environment Configuration
# Copy this file to .env and configure for your environment

# ============================================================================
# ENVIRONMENT
# ============================================================================
# Application environment: development, staging, production
ENVIRONMENT=development

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
# IMPORTANT: In production, set specific allowed origins (comma-separated)
# DO NOT use wildcard (*) in production!

# Development example (localhost)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000,http://localhost:8080

# Production example (uncomment and customize)
# CORS_ORIGINS=https://app.alphavelocity.com,https://www.alphavelocity.com

# Allow credentials (cookies, authorization headers)
# Default: true
CORS_ALLOW_CREDENTIALS=true

# Allowed HTTP methods (comma-separated or *)
# Default: * (all methods)
CORS_ALLOW_METHODS=*

# Allowed headers (comma-separated or *)
# Default: * (all headers)
CORS_ALLOW_HEADERS=*

# Preflight cache duration in seconds
# Default: 600 (10 minutes)
CORS_MAX_AGE=600

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
# Default: INFO
LOG_LEVEL=INFO

# Log directory path
# Default: logs
LOG_DIR=logs

# Use JSON logging format (recommended for production)
# Default: false
JSON_LOGS=false

# ============================================================================
# DATABASE CONFIGURATION (PostgreSQL)
# ============================================================================
# Database host
DB_HOST=localhost

# Database port
DB_PORT=5432

# Database name
DB_NAME=alphavelocity

# Database user
DB_USER=alphavelocity

# Database password (KEEP SECRET!)
DB_PASSWORD=alphavelocity

# ============================================================================
# API CONFIGURATION
# ============================================================================
# API host and port for uvicorn
API_HOST=0.0.0.0
API_PORT=8000

# Number of worker processes (production)
# Default: 1
# API_WORKERS=4

# Enable auto-reload (development only)
# Default: false
API_RELOAD=true

# ============================================================================
# AUTHENTICATION (JWT)
# ============================================================================
# Secret key for JWT tokens (GENERATE A SECURE RANDOM KEY!)
# Use: python -c "import secrets; print(secrets.token_urlsafe(32))"
# In development: auto-generated if missing (sessions won't survive restarts)
# In production (ENVIRONMENT=production): REQUIRED â€” app will refuse to start without it
SECRET_KEY=

# Access tokens expire after 1 hour; refresh tokens after 7 days.
# These values are set in backend/auth.py and are not configurable via env.

# ============================================================================
# RATE LIMITING
# ============================================================================
# Enable/disable rate limiting
# Default: true (HIGHLY RECOMMENDED for production)
RATE_LIMIT_ENABLED=true

# Rate limit storage backend
# Options:
#   - memory:// (in-memory, simple, lost on restart)
#   - redis://localhost:6379 (Redis, recommended for production/multi-worker)
# Default: memory://
RATE_LIMIT_STORAGE_URL=memory://

# Rate limit strategy
# Options:
#   - fixed-window: Simple counter per time window
#   - moving-window: More accurate but slightly more expensive
# Default: fixed-window
RATE_LIMIT_STRATEGY=fixed-window

# Default rate limit for public API endpoints
# Format: <count>/<period> where period can be: second, minute, hour, day
# Default: 100/minute
DEFAULT_RATE_LIMIT=100/minute

# Rate limit for authentication endpoints (login, register)
# IMPORTANT: Keep this strict to prevent brute force attacks
# Default: 5/minute
AUTH_RATE_LIMIT=5/minute

# Rate limit for expensive operations (portfolio analysis, momentum calculations)
# Default: 10/minute
EXPENSIVE_RATE_LIMIT=10/minute

# Rate limit for authenticated users (higher than anonymous)
# Default: 200/minute
AUTHENTICATED_RATE_LIMIT=200/minute

# IP addresses exempt from rate limiting (comma-separated)
# Use for internal services, health checks, admin IPs
# Example: 127.0.0.1,10.0.0.1,192.168.1.100
RATE_LIMIT_EXEMPT_IPS=

# ============================================================================
# REDIS CACHING
# ============================================================================
# Enable Redis caching (recommended for production)
# If disabled, falls back to in-memory cache (not suitable for multi-worker)
# Default: false
REDIS_ENABLED=false

# Redis server host
# Default: localhost
REDIS_HOST=localhost

# Redis server port
# Default: 6379
REDIS_PORT=6379

# Redis database number (0-15)
# Default: 0
REDIS_DB=0

# Redis password (if authentication enabled)
# Leave empty if no password
REDIS_PASSWORD=

# Cache key prefix (to avoid collisions with other apps)
# Default: alphavelocity:
REDIS_PREFIX=alphavelocity:

# Default cache TTL in seconds (1 hour)
# Default: 3600
CACHE_DEFAULT_TTL=3600

# Price cache TTL in seconds (5 minutes)
# Prices change frequently, keep TTL short
# Default: 300
CACHE_PRICE_TTL=300

# Momentum score cache TTL in seconds (30 minutes)
# Momentum calculations are expensive, cache longer
# Default: 1800
CACHE_MOMENTUM_TTL=1800

# Portfolio analysis cache TTL in seconds (10 minutes)
# Portfolio analysis is very expensive
# Default: 600
CACHE_PORTFOLIO_TTL=600

# ============================================================================
# CONCURRENT PROCESSING
# ============================================================================
# Maximum concurrent workers for batch operations
# Higher values = faster processing but more resource usage
# Default: 10
CONCURRENT_MAX_WORKERS=10

# Batch size for processing large lists
# Larger batches = fewer iterations but more memory
# Default: 20
CONCURRENT_BATCH_SIZE=20

# Timeout per concurrent operation (seconds)
# Default: 30
CONCURRENT_TIMEOUT=30

# Rate limit for external API calls (calls per second)
# Helps prevent hitting API rate limits
# Default: None (no limit)
# CONCURRENT_RATE_LIMIT=10

# ============================================================================
# RATE LIMITING
# ============================================================================
# Enable rate limiting
# Default: true
# RATE_LIMIT_ENABLED=true

# Requests per minute for authenticated users
# Default: 60
# RATE_LIMIT_PER_MINUTE=60

# Requests per minute for anonymous users
# Default: 20
# RATE_LIMIT_ANONYMOUS_PER_MINUTE=20

# ============================================================================
# EXTERNAL SERVICES
# ============================================================================
# Financial data provider (yfinance is default, no key required)
# If using Alpha Vantage or other providers:
# ALPHA_VANTAGE_API_KEY=your_api_key_here

# ============================================================================
# CACHE CONFIGURATION
# ============================================================================
# Redis host (if using Redis for caching)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_DB=0
# REDIS_PASSWORD=

# Cache TTL in seconds
# Default: 86400 (24 hours)
CACHE_TTL=86400

# ============================================================================
# FEATURE FLAGS
# ============================================================================
# Enable database mode (vs file-based)
# Default: true if database is configured
# DATABASE_MODE=true

# Enable historical data tracking
# Default: true
# HISTORICAL_TRACKING=true

# Enable daily cache scheduler
# Default: true
# DAILY_CACHE_ENABLED=true

# ============================================================================
# DEVELOPMENT SETTINGS
# ============================================================================
# Enable debug mode (DO NOT use in production!)
# Default: false
# DEBUG=false

# Enable SQL query logging
# Default: false
# SQL_ECHO=false

# Enable detailed error messages
# Default: false in production
# DETAILED_ERRORS=false

# ============================================================================
# PRODUCTION SECURITY SETTINGS
# ============================================================================
# IMPORTANT: For production deployment, ensure:
# 1. ENVIRONMENT=production
# 2. CORS_ORIGINS set to specific domains (no wildcards!)
# 3. SECRET_KEY is a strong, random value
# 4. DB_PASSWORD is secure and rotated regularly
# 5. JSON_LOGS=true for log aggregation
# 6. LOG_LEVEL=WARNING or ERROR to reduce log volume
# 7. DEBUG=false
# 8. DETAILED_ERRORS=false

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================
# - Never commit .env file to version control
# - Use secrets management in production (AWS Secrets Manager, etc.)
# - Rotate secrets regularly
# - Use environment-specific .env files (.env.production, .env.staging)
# - Validate all required variables are set before starting application
